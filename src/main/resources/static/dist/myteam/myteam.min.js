function init(){getReportees(getADLoginID(),!1,""),loadingProposedButton(),getEmailList(),initSelect(),$("#add-reportee-note").click(function(){openAddReporteeNoteModal()}),$("#submit-reportee-note").click(function(){clickSubmitReporteeNote()}),$("#edit-manager-evaluation").click(function(){editManagerEvaluation()}),$("#save-manager-evaluation").click(function(){saveManagerEvaluation()}),$("#cancel-manager-evaluation").click(function(){closeManagerEvaluation(!1)}),$(".reportee-note-validate").on("input",function(){validateForm("reportee-note-validate","submit-reportee-note")})}function getReportees(e,t){t&&loadingSubReporteeList(),$.ajax({url:"http://"+getEnvironment()+"/getReportees/"+e,cache:!1,method:"GET",xhrFields:{withCredentials:!0},success:function(a){675590==e&&(a=demoManager1()),674936==e&&(a=demoManager2()),t?(updateSelectedSubReportee(e),addSubReporteesToList(a)):($("#reportee-list").empty(),$("#info-holder").append("<span id='info-message' class='text-center'><h5>Please select a reportee </h5></span>"),$.each(a,function(e,t){addReporteeToList(t.employeeID,t.fullName,t.username,t.emailAddress)}))},error:function(e,t,a){$("#reportee-list").empty(),console.log("error",a),toastr.error("Sorry, there was a problem getting reportees, please try again later.")}})}function demoManager1(){return[{employeeID:678124,surname:"BRARD",forename:"Alexandre",username:"abrard",emailAddresses:["alexandre.brard@soprasteria.com"],isManager:!1,hasHRDash:!0,company:"Sopra Steria Limited",steriaDepartment:"Scotland People (DPC181)",sector:"GOV5",superSector:"SS Government (GOV)",reporteeCNs:[],accountExpires:null,fullName:"Alexandre BRARD"},{employeeID:675715,surname:"MCINTYRE",forename:"Chris",username:"chmcinty",emailAddresses:["chris.mcintyre@soprasteria.com"],isManager:!1,hasHRDash:!0,company:"Sopra Steria Limited",steriaDepartment:"Scotland People (DPC181)",sector:"GOV5",superSector:"SS Government (GOV)",reporteeCNs:[],accountExpires:null,fullName:"Chris MCINTYRE"},{employeeID:674936,surname:"HARRIS",forename:"Finlay",username:"fharris",emailAddresses:["finlay.harris@soprasteria.com"],isManager:!1,hasHRDash:!0,company:"Sopra Steria Limited",steriaDepartment:"Scotland People (DPC181)",sector:"GOV5",superSector:"SS Government (GOV)",reporteeCNs:[],accountExpires:null,fullName:"Finlay HARRIS"}]}function demoManager2(){return[{employeeID:675590,surname:"NACEF",forename:"Ridhwan",username:"rnacef",emailAddresses:["ridhwan.nacef@soprasteria.com"],isManager:!1,hasHRDash:!0,company:"Sopra Steria Limited",steriaDepartment:"Scotland People (DPC181)",sector:"GOV5",superSector:"SS Government (GOV)",reporteeCNs:[],accountExpires:null,fullName:"Ridhwan NACEF"},{employeeID:676783,surname:"MEHMET",forename:"Mehmet",username:"mmehmet",emailAddresses:["mehmet.mehmet@soprasteria.com"],isManager:!1,hasHRDash:!0,company:"Sopra Steria Limited",steriaDepartment:"Scotland People (DPC181)",sector:"GOV5",superSector:"SS Government (GOV)",reporteeCNs:[],accountExpires:null,fullName:"Mehmet MEHMET"}]}function loadingSubReporteeList(){$("#reportee-sub-selected").html("<h5>Loading...</h5>"),$("#reportee-sub-list").empty()}function removeApostrophe(e){return-1!=e.indexOf("'")&&(e=e.replace(/'/g,"")),e}function addReporteeToList(e,t,a,o){initialReporteeList.push(e),$("#reportee-list").append(reporteeListItemHTML(e,t,a,o))}function addSubReporteesToList(e){var t="";e.length>0&&(t="<h5><b> "+selectedReporteeName+" - Team </b></h5>",$.each(e,function(e,a){t+=reporteeListItemHTML(a.employeeID,a.fullName,a.username,a.emailAddress)})),$("#reportee-sub-list").html(t)}function updateSelectedSubReportee(e){-1==jQuery.inArray(e,initialReporteeList)?($("#reportee-sub-selected").html("<h5><b>Selected Employee</b></h5>"+reporteeListItemHTML(e,selectedReporteeName,selectedReporteeUserName,selectedReporteeEmail)),$("#panel-"+e).addClass("selected-panel")):$("#reportee-sub-selected").empty()}function reporteeListItemHTML(e,t,a,o){return" \t\t<div id='panel-"+e+"' class='panel panel-default reportee-panel' style='cursor:pointer' onClick='getReporteeCareer("+e+',"'+removeApostrophe(t)+'", "'+o+'",  "'+a+"\", this)' > \t\t    <div class='panel-heading'> \t\t        <div class='row'> \t\t           <div class='col-md-2'> \t\t           \t\t"+getProfilePicture(a,36)+" \t\t           </div> \t\t           <div class='col-md-8'><h5><b>"+t+"</b></h5></div> \t\t        </div> \t\t    </div> \t\t  </div>   "}function selectedReportee(e){$(".reportee-panel").each(function(t){e.id==this.id?$(this).addClass("selected-panel"):$(this).removeClass("selected-panel")})}function getReporteeCareer(e,t,a,o,i){checkSelectedUser(parseInt(e),a,t,o)&&(selectedReportee(i),clearReporteeLists(),showReporteeView(e,t),getObjectivesList(e),getReporteeCompetencyList(e),getGeneralFeedbackList(e),getDevelopmentNeedsList(e),getReporteeNotesList(e),getReporteeRatings(e),getReportees(e,!0))}function getReporteeCompetencyList(e){$.ajax({url:"http://"+getEnvironment()+"/getCompetencies/"+e,cache:!1,method:"GET",xhrFields:{withCredentials:!0},success:function(e){var t=[];$.each(e,function(e,a){a.isSelected&&t.push(a.title)}),addCompetenciesToList(t)},error:function(e,t,a){console.log("error",a),toastr.error("Sorry, there was a problem getting competencies, please try again later.")}})}function getReporteeNotesList(e){$.ajax({url:"http://"+getEnvironment()+"/getNotes/"+e,cache:!1,method:"GET",xhrFields:{withCredentials:!0},success:function(e){$.each(e,function(e,t){var a=timeStampToDateTime(new Date(t.timestamp));addNoteToReporteeList(t.providerName,t.noteDescription,a)})},error:function(e,t,a){console.log("error",a),toastr.error("Sorry, there was a problem getting notes, please try again later.")}})}function proposeObjective(e,t,a,o,i){$.ajax({url:"http://"+getEnvironment()+"/proposeObjective/"+e,method:"POST",xhrFields:{withCredentials:!0},data:{title:t,description:a,dueDate:o,emails:i},success:function(e){-1!==e.indexOf("Objective Proposed for")&&-1!==e.indexOf("Error")?toastr.warning(e):-1!==e.indexOf("Error")?toastr.error(e):(-1!==i.indexOf(selectedReporteeEmail.trim())&&addObjectiveToList(nextObjectiveID(),t,a,o,0,!1),toastr.success(e))},error:function(e,t,a){var o=e.responseText.toLowerCase();o.indexOf("objective proposed")>-1?toastr.warning(e.responseText):toastr.error(o)}})}function addNoteToReporteeDB(e,t,a,o){$.ajax({url:"http://"+getEnvironment()+"/addNoteToReportee/"+getADLoginID(),method:"POST",xhrFields:{withCredentials:!0},data:{reporteeEmployeeID:e,providerName:t,noteDescription:a},success:function(e){0==lastNoteID&&$("#general-notes-list").removeClass("text-center").empty(),lastNoteID++,addNoteToReporteeList(t,a,o),toastr.success(e)},error:function(e,t,a){toastr.error(e.responseText)}})}function clearReporteeLists(){$("#reportee-obj-list, #reportee-comp-list, #reportee-feed-list, #reportee-dev-needs-list, #reportee-notes-list").empty()}function checkSelectedUser(e,t,a,o){return selectedReporteeID!=e&&(selectedReporteeID=e,selectedReporteeEmail=t,selectedReporteeName=a,selectedReporteeUserName=o,!0)}function showReporteeView(e,t){$(".reportee-name").each(function(){$(this).text(t)}),$("#reportee-notes-add-button").empty(),$("#edit-manager-evaluation").hide(),jQuery.inArray(e,initialReporteeList)>-1&&showEditOptions(),reporteeSectionHidden&&($("#info-message").remove(),$("#reportee-body").removeClass("hidden"),reporteeSectionHidden=!1)}function openAddReporteeNoteModal(){$("#reportee-note-input").val(""),showReporteeNoteModal(!0)}function showReporteeNoteModal(e){e?($("#submit-reportee-note").prop("disabled",!0),$("#reportee-note-modal").modal({backdrop:"static",keyboard:!1,show:!0})):$("#reportee-note-modal").modal("hide")}function clickSubmitReporteeNote(){var e=selectedReporteeID,t=getADfullName(),a=$("#reportee-note-input").val().trim(),o=timeStampToDateTime(new Date);addNoteToReporteeDB(e,t,a,o),showReporteeNoteModal(!1)}function addObjectiveToList(e,t,a,o,i,s){!1!==s&&"false"!==s||$("#reportee-obj-list").append(reporteeObjectiveListHTML(e,t,a,o,i,s))}function addCompetenciesToList(e){0==e.length&&$("#reportee-comp-list").append("No Competencies have been selected."),$("#reportee-comp-list").append(reporteeCompetenciesListHTML(e))}function addDevelopmentNeedToList(e,t,a,o,i,s){lastDevID=e,$("#reportee-dev-needs-list").append(reporteeDevelopmentNeedListHTML(e,t,a,o,i,s))}function addGeneralFeedbackToList(e,t,a,o,i){$("#reportee-feed-list").append(reporteeFeedbackDescriptionListHTML(e,t,a,o,i))}function addNoteToReporteeList(e,t,a){$("#reportee-notes-list").prepend(reporteeNotesListHTML(e,t,a))}function reporteeObjectiveListHTML(e,t,a,o,i,s){return"     <div class='panel-group' id='objective-item-"+e+"'>         <div class='panel panel-default' id='panel'>         <input type='hidden' id='obj-status-"+e+"' value='"+i+"'>         <input type='hidden' id='obj-is-archived-"+e+"' value='"+s+"'>         \t<div class='panel-heading'>             \t<div class='row'>             \t\t<div class='col-sm-6'> \t            \t\t<div class='row'> \t\t            \t\t<div class='col-sm-6' id='obj-no-"+e+"'><h6><b>#"+e+"</b></h6></div> \t\t            \t\t<div class='col-sm-6' id='obj-date-"+e+"'><h6 class='pull-right'><b>"+o+"</b></h6></div> \t            \t\t</div> \t            \t\t<div class='row'> \t\t            \t\t<div class='col-sm-12 wrap-text' id='obj-title-"+e+"'>"+t+"</div> \t            \t\t</div>             \t\t</div>             \t\t<div class='col-sm-5 bs-wizard'>             \t\t\t <div class='col-xs-4 bs-wizard-step complete' id='proposed-obj-dot-"+e+"'> \t\t\t\t\t      <div class='text-center' id='test'><h6>Proposed</h6></div> \t\t\t\t\t      <div  class='bs-wizard-dot-start'></div> \t\t\t\t\t     </div> \t\t\t\t\t     <div class='col-xs-4 bs-wizard-step "+checkComplete(i,1)+"' id='started-obj-dot-"+e+"'> \t\t\t\t\t       <div class='text-center'><h6>In-Progress</h6></div> \t\t\t\t\t       <div class='progress'><div class='progress-bar'></div></div> \t\t\t\t\t       <div  class='bs-wizard-dot-start'></div> \t\t\t\t\t       <div  class='bs-wizard-dot-complete'></div> \t\t\t\t\t     </div> \t\t\t\t\t     <div class='col-xs-4 bs-wizard-step  "+checkComplete(i,2)+"' id='complete-obj-dot-"+e+"'> \t\t\t\t\t       <div class='text-center'><h6>Complete</h6></div> \t\t\t\t\t       \t <div class='progress'><div class='progress-bar'></div></div> \t\t\t\t\t        <div class='bs-wizard-dot-start'></div> \t\t\t\t\t        <div  class='bs-wizard-dot-complete'></div> \t\t\t\t\t     </div>             \t\t</div>             \t\t<div class='col-sm-1 chev-height'> \t\t\t\t\t  <a data-toggle='collapse' href='#collapse-obj-"+e+"' class='collapsed'></a> \t\t\t\t\t</div>             \t</div>             </div>                     <div id='collapse-obj-"+e+"' class='panel-collapse collapse'>                     <div class='panel-body'>                     <div class='row'>                         <div class='col-md-4'>                             <h5><b>Description</b></h5>                         </div>                         <div class='col-md-8'>                         </div>                     </div>                     <div class='row'>                         <div class='col-md-12 wrap-text'>                             <p id='obj-text-"+e+"'>"+a+"</p>                         </div>                     </div>                 </div>             </div>                  </div>     </div>     "}function reporteeCompetenciesListHTML(e){for(var t="",a=0;a<e.length;a++)t+=e[a],a==e.length-1?t+=".":t+=", ";return t}function reporteeFeedbackDescriptionListHTML(e,t,a,o,i){return" \t<ul class='list-group'> \t\t<li class='list-group-item'> \t\t\t<div class='row'> \t\t\t\t<div class='col-md-6'><h6><b>"+t+"</b></h6></div> \t\t\t\t<div class='col-md-6'><h6 class='pull-right'><b>"+o+"</b></h6></div> \t\t\t</div> \t\t\t<div class='row'> \t\t\t\t<div class='col-md-12 wrap-text'><h5>"+a+"</h5></div> \t\t\t</div> \t\t</li> \t</ul>"}function reporteeDevelopmentNeedListHTML(e,t,a,o,i,s){return" \t    <div class='panel-group' id='dev-need-item-"+e+"'> \t        <div class='panel panel-default' id='panel'> \t\t        <input type='hidden' id='dev-need-status-"+e+"' value='"+s+"'> \t\t        <input type='hidden' id='dev-need-category-id-"+e+"' value='"+o+"'> \t        \t<div class='panel-heading'> \t            \t<div class='row'> \t            \t\t<div class='col-sm-6'> \t\t            \t\t<div class='row'> \t\t\t            \t\t<div class='col-sm-6' id='dev-need-no-"+e+"'><h6><b>#"+e+"</b></h6></div> \t\t\t            \t\t<div class='col-sm-6' id='dev-need-date-"+e+"'><h6 class='pull-right'><b>"+i+"</b></h6></div> \t\t            \t\t</div> \t\t            \t\t<div class='row'> \t\t\t            \t\t<div class='col-sm-12 wrap-text' id='dev-need-title-"+e+"'>"+t+"</div> \t\t            \t\t</div> \t            \t\t</div> \t            \t\t<div class='col-sm-5 bs-wizard'> \t            \t\t\t <div class='col-xs-4 bs-wizard-step complete' id='proposed-dev-need-dot-"+e+"'> \t\t\t\t\t\t      <div class='text-center' id='test'><h6>Proposed</h6></div> \t\t\t\t\t\t      <div  class='bs-wizard-dot-start'></div> \t\t\t\t\t\t     </div> \t\t\t\t\t\t     <div class='col-xs-4 bs-wizard-step "+checkComplete(s,1)+"' id='started-dev-need-dot-"+e+"'> \t\t\t\t\t\t       <div class='text-center'><h6>In-Progress</h6></div> \t\t\t\t\t\t       <div class='progress'><div class='progress-bar'></div></div> \t\t\t\t\t\t       <div  class='bs-wizard-dot-start'></div> \t\t\t\t\t\t       <div  class='bs-wizard-dot-complete'></div> \t\t\t\t\t\t     </div> \t\t\t\t\t\t     <div class='col-xs-4 bs-wizard-step  "+checkComplete(s,2)+"' id='complete-dev-need-dot-"+e+"'> \t\t\t\t\t\t       <div class='text-center'><h6>Complete</h6></div> \t\t\t\t\t\t       \t <div class='progress'><div class='progress-bar'></div></div> \t\t\t\t\t\t        <div class='bs-wizard-dot-start'></div> \t\t\t\t\t\t        <div  class='bs-wizard-dot-complete'></div> \t\t\t\t\t\t     </div> \t            \t\t</div> \t            \t\t<div class='col-sm-1 chev-height'> \t\t\t\t\t\t  <a data-toggle='collapse' href='#collapse-dev-need-"+e+"' class='collapsed'></a> \t\t\t\t\t\t</div> \t            \t</div> \t            </div> \t            <div id='collapse-dev-need-"+e+"' class='panel-collapse collapse'> \t                <div class='panel-body'> \t                    <div class='row'> \t                        <div class='col-md-6'> \t                            <h5><b>Description</b></h5> \t                        </div> \t                       \t<div class='col-md-6' > \t                        \t<input type='hidden' id='dev-need-category-id-"+e+"' value='"+o+"'> \t\t                        <h6><b> Category: </b><span id='dev-need-category-"+e+"'>"+categoryList[o]+"</span></h6>\t\t                    </div> \t                    </div> \t                    <div class='row'> \t                        <div class='col-md-12 wrap-text'> \t                            <p id='dev-need-text-"+e+"'>"+a+"</p> \t                        </div> \t                    </div> \t                </div> \t            </div> \t         \t        </div> \t    </div> \t    "}function reporteeNotesListHTML(e,t,a){return" \t  <ul class='list-group-item'> \t  \t<div class='row'> \t\t\t<div class='col-md-6 wrap-text'><h6 ><b>"+e+"</b></h6></div> \t\t\t<div class='col-md-6'><h6 class='pull-right'><b>"+a+"</b></h6></div> \t\t</div> \t\t<div class='row'> \t\t\t<div class='col-md-12 wrap-text'><p>"+t+"</p></div> \t\t</div> \t  </ul> \t  "}function addProposed(){$("#nav-bar-buttons").empty(),"true"!==isUserManager()&&1!=isUserManager()||$("#nav-bar-buttons").prepend("<button type='button' class='btn btn-default navbar-btn pull-right' id='proposed-objective' onClick='openProposedObjectiveModal()'>Propose Objective</button>")}function initialiseTags(){addProposed()}function loadingProposedButton(){$("#nav-bar-buttons").append("<h5 class='pull-right'> Loading... <h5>")}function getReporteeRatings(e){getCurrentRatingAction(e,function(e){setMyRatings(e.selfEvaluation,e.managerEvaluation,e.score)})}function setMyRatings(e,t,a){var o=""===e?NO_REPORTEE_EVALUATION:e;setManagerEvaluationLabel(t),$managerEvaluationInput.val(t),$reporteeEvaluationText.text(o),setEvaluationScoreLabel(a),$evaluationScoreInput.selectpicker("val",a)}function setManagerEvaluationLabel(e){var t=""==e?NO_MANAGER_EVALUATION:e;$managerEvaluationText.text(t)}function setEvaluationScoreLabel(e){var t=0==e?NO_RATING:RATING+e;$evaluationScoreText.text(t)}function editManagerEvaluation(){$managerEvaluationLabels.hide(),$managerEvaluationOptions.show()}function saveManagerEvaluation(){addManagerEvaluationAction(getADLoginID(),selectedReporteeID,$managerEvaluationInput.val(),$evaluationScoreInput.val(),function(e){closeManagerEvaluation(!0)})}function closeManagerEvaluation(e){$managerEvaluationOptions.hide(),e&&(setManagerEvaluationLabel($managerEvaluationInput.val()),setEvaluationScoreLabel($evaluationScoreInput.val())),$managerEvaluationLabels.show()}function initSelect(){$("#evaluation-score-input").selectpicker({width:"40%"})}function showEditOptions(){$("#reportee-notes-add-button").append(addNotesHTML()),$("#edit-manager-evaluation").show()}function addNotesHTML(){return" \t\t<div class='row'> \t\t\t<div class='col-md-12'> \t\t\t\t<button type='button' class='btn btn-link pull-right' onClick='openAddReporteeNoteModal()'><u>Add Note for "+selectedReporteeName+"</u></button> \t\t\t</div> \t\t</div> \t\t"}$(function(){init()});const NO_REPORTEE_EVALUATION="No self evaluation has been written.",NO_MANAGER_EVALUATION="No manager evaluation has been written.",NO_RATING="No Rating Entered",RATING="Rating: ";var $managerEvaluationOptions=$(".manager-evaluation-options"),$managerEvaluationLabels=$(".manager-evaluation-labels"),$managerEvaluationText=$("#manager-evaluation-text"),$managerEvaluationInput=$("#manager-evaluation-input"),$reporteeEvaluationText=$("#reportee-evaluation-text"),$evaluationScoreText=$("#evaluation-score-text"),$evaluationScoreInput=$("#evaluation-score-input"),reporteeSectionHidden=!0,selectedReporteeID=0,selectedReporteeEmail="",selectedReporteeName="",selectedReporteeUsername="",initialReporteeList=[];