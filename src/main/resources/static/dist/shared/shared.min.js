function adjustDatePicker(){$.fn.datepicker.noConflict=function(){return $.fn.datepicker=old,this}}function getObjectivesList(e){$.ajax({url:"http://"+getEnvironment()+"/getObjectives/"+e,cache:!1,method:"GET",xhrFields:{withCredentials:!0},success:function(e){$.each(e,function(e,t){nextObjId.push(t.id);var o=formatDate(t.dueDate),a=numberProgress(t.progress);addObjectiveToList(t.id,t.title,t.description,o,a,t.archived,t.proposedBy,t.createdOn)}),0==e.length&&$("#all-obj").addClass("text-center").append("<h5>You have no Objectives</h5>")},error:function(e,t,o){console.log("error",o),toastr.error("Sorry, there was a problem getting objectives, please try again later.")}})}function nextObjectiveID(){if(nextObjId.length<1)return nextObjId.push(1),1;nextObjId.sort(function(e,t){return e-t});var e=nextObjId[nextObjId.length-1];return nextObjId.push(++e),e}function numberProgress(e){switch(e){case"Proposed":return 0;case"In-Progress":return 1;case"Complete":return 2}}function numberCategory(e){switch(e){case categoryList[0]:return 0;case categoryList[1]:return 1;case categoryList[2]:return 2;case categoryList[3]:return 3;case categoryList[4]:return 4}}function checkComplete(e,t){return e>=t?"complete":""}function setObjectiveModalContent(e,t,o,a,n,i){2==i?($("#proposedTo").html(proposedToHTML()),tags("proposed-obj-to",emails),keypress("objective-modal")):$("#proposedTo").html(""),$("#obj-modal-title-type").text(modalStatusList[i]),$("#objective-id").val(e),$("#objective-title").val(t),$("#objective-text").val(o),$("#objective-date").val(a),$("#objective-status").val(n),$("#submit-obj").prop("disabled",enableSubmit(i))}function showObjectiveModal(e){e?$("#objective-modal").modal({backdrop:"static",keyboard:!1,show:!0}):(setObjectiveModalContent("","","",getToday(),0,0),$("#proposed-obj-to").val(""),$("#objective-modal").modal("hide"))}function clickSubmitObjective(){var e=$("#obj-modal-type").val(),t=getADLoginID(),o=$("#objective-id").val(),a=$("#objective-title").val().trim(),n=$("#objective-text").val().trim(),i=$("#objective-date").val().trim(),s=parseInt($("#objective-status").val());$("#objective-is-archived").val();if(checkIfPastDate(i)||checkEmpty("objective-modal-validate",!0))return!1;if("add"===e)addObjectiveToDB(t,a,n,i,getADfullName()),showObjectiveModal(!1);else if("edit"===e)editObjectiveOnDB(t,o,a,n,i,s,getADfullName()),showObjectiveModal(!1);else{var r=$("#proposed-obj-to").val().trim();validEmails(r)?(proposeObjective(t,a,n,i,r),showObjectiveModal(!1)):(toastr.error("One or more email addresses entered are not valid"),showObjectiveModal(!0))}}function showProposedObjTab(){$("#obj-all-tab").hasClass("active")||$("#obj-proposed-tab").find("a").trigger("click")}function clickCloseObjective(e){"edit"===$("#obj-modal-type").val()||checkEmptyID("objective-title",!1)&&checkEmptyID("objective-text",!1)?$("#objective-modal").modal("hide"):(addHTMLforPopUpBox("objective-modal"),$(this).closest("form"),e.preventDefault(),$("#confirm").modal({backdrop:"static",keyboard:!1}).one("click","#close-modals",function(e){$("#objective-modal").modal("hide")}))}function getCompetencyList(e){$.ajax({url:"http://"+getEnvironment()+"/getCompetencies/"+e,cache:!1,method:"GET",xhrFields:{withCredentials:!0},success:function(e){$.each(e,function(e,t){addCompetencyToList(t.id,t.title,competenciesDescriptions[t.id],t.selected)})},error:function(e,t,o){console.log("error",o),toastr.error("Sorry, there was a problem getting competencies, please try again later.")}})}function checkSelected(e){return e?"":"-empty"}function getGeneralFeedbackList(e){$.ajax({url:"http://"+getEnvironment()+"/getFeedback/"+e,cache:!1,method:"GET",xhrFields:{withCredentials:!0},success:function(e){$.each(e,function(e,t){var o=timeStampToClassDate(t.timestamp),a=timeStampToLongDate(new Date(t.timestamp)),n=t.providerName?t.providerName:t.providerEmail;addGeneralFeedbackToList(t.id,n,t.feedbackDescription,a,o,t.providerEmail,t.taggedObjectiveIds,t.taggedDevelopmentNeedIds)}),0==e.length&&($("#generalFeeDescription").addClass("text-center").append("<h5>You have no Feedback </h5>"),$("#general-reviewer-list").addClass("text-center").append("<h5>You have no Reviewers </h5>"),$("#general-feedback-tab").addClass("text-center").append("<h5>You have no Reviewers </h5>"))},error:function(e,t,o){console.log("error",o),toastr.error("Sorry, there was a problem getting feedback, please try again later.")}})}function clickCloseSendFeedback(e){if(checkEmptyID("sendingTo",!1)&&checkEmptyID("sendingText",!1))$("#sendFeedbackModal").modal("hide");else{addHTMLforPopUpBox("send-feedback-modal");$(this).closest("form");e.preventDefault(),$("#confirm").modal({backdrop:"static",keyboard:!1}).one("click","#close-modals",function(e){$("#sendFeedbackModal").modal("hide"),$("textarea").val(""),$("#sendingTo").tagsinput("removeAll")})}}function clickCloseRequestFeedback(e){if(checkEmptyID("requestingTo",!1)&&checkEmptyID("requestingText",!1))$("#requestFeedbackModal").modal("hide");else{addHTMLforPopUpBox("request-feedback-modal");$(this).closest("form");e.preventDefault(),$("#confirm").modal({backdrop:"static",keyboard:!1}).one("click","#close-modals",function(e){$("#requestFeedbackModal").modal("hide"),$("textarea").val(""),$("#requestingTo").tagsinput("removeAll")})}}function getDevelopmentNeedsList(e){$.ajax({url:"http://"+getEnvironment()+"/getDevelopmentNeeds/"+e,cache:!1,method:"GET",xhrFields:{withCredentials:!0},success:function(e){$.each(e,function(e,t){nextDevNeedId.push(t.id);var o=isOngoing(t.dueDate)?t.dueDate:formatDate(t.dueDate),a=numberProgress(t.progress),n=numberCategory(t.category);addDevelopmentNeedToList(t.id,t.title,t.description,n,o,a,t.archived,t.createdOn)}),0==e.length&&$("#all-dev-need").addClass("text-center").append("<h5>You have no Development Needs</h5>")},error:function(e,t,o){console.log("error",o),toastr.error("Sorry, there was a problem getting development needs, please try again later.")}})}function setDevelopmentNeedModalContent(e,t,o,a,n,i,s){$("#dev-need-modal-title-type").text(modalStatusList[i]),$("#development-need-id").val(e),$("#development-need-title").val(t),$("#development-need-text").val(o),$("#"+a).prop("checked",!0),$("#development-need-date").val(n),$("#development-need-status").val(s),$("#submit-dev-need").prop("disabled",enableSubmit(i))}function showDevelopmentNeedModal(e){e?$("#development-need-modal").modal({backdrop:"static",keyboard:!1,show:!0}):(setDevelopmentNeedModalContent("","","",categoryIDs[0],getToday(),0,0),$("#development-need-modal").modal("hide"))}function isOngoing(e){return"Ongoing"===e}function clickCloseDevNeed(e){"edit"===$("#dev-need-modal-type").val()||checkEmptyID("development-need-title",!1)&&checkEmptyID("development-need-text",!1)?$("#development-need-modal").modal("hide"):(addHTMLforPopUpBox("development-need-modal"),$(this).closest("form"),e.preventDefault(),$("#confirm").modal({backdrop:"static",keyboard:!1}).one("click","#close-modals",function(e){$("#development-need-modal").modal("hide")}))}function showProposedDevelopmentTab(){$("#dev-need-all-tab").hasClass("active")||$("#dev-need-proposed-tab").find("a").trigger("click")}function nextDevelopmentNeedID(){if(nextDevNeedId.length<1)return nextDevNeedId.push(1),1;nextDevNeedId.sort(function(e,t){return e-t});var e=nextDevNeedId[nextDevNeedId.length-1];return nextDevNeedId.push(++e),e}function addNoteToDB(e,t,o,a){$.ajax({url:"http://"+getEnvironment()+"/addNote/"+e,method:"POST",xhrFields:{withCredentials:!0},data:{providerName:t,noteDescription:o},success:function(e){0==lastNoteID&&$("#general-notes-list").removeClass("text-center").empty(),clearAllNotesFilters();var n=timeStampToDateTimeGMT(a),i=timeStampToClassDate(new Date);addNoteToList(++lastNoteID,t,o,n,i,emptyArray,emptyArray),toastr.success(e)},error:function(e,t,o){toastr.error(e.responseText)}})}function getTags(e){$.ajax({async:!0,url:"http://"+getEnvironment()+"/getTags/"+e,cache:!1,method:"GET",xhrFields:{withCredentials:!0},success:function(e){var t="<option value='0'>No Filter</option>";$.each(e,function(e,o){t+="<optgroup label='"+e+"' id='"+e+"-group'>",$.each(o,function(o,a){addToTagsLists(e,o,a),t+=addToOptionsList(e,o,a)}),t+="</optgroup>"}),$(".tag-filter-dropdown").html(t).selectpicker("refresh")},error:function(e,t,o){console.log("error",o),toastr.error("Sorry, there was a problem getting tags, please try again later.")}})}function addToTagsLists(e,t,o){"objectivesTags"===e?$("#objectives-tags-checkboxes").append(tagsCheckboxItemHTML(t,o,"objective")):$("#development-needs-tags-checkboxes").append(tagsCheckboxItemHTML(t,o,"development-need"))}function addToOptionsList(e,t,o){return"objectivesTags"===e?tagsOptionItemHTML(t,o,"obj"):tagsOptionItemHTML(t,o,"dev")}function tagsCheckboxItemHTML(e,t,o){return" \t\t<div class='col-md-12 checkbox' id='checkbox-"+o+"-"+e+"'> \t\t <label> \t\t    <input class='"+o+"-tag-checkbox' type='checkbox' value='"+e+"'> \t\t    <b>#"+e+": </b><span class='checkbox-title'>"+t+"</span> \t\t  </label> \t\t </div>\t\t    "}function tagsOptionItemHTML(e,t,o){return"<option value='"+o+"-"+e+"'>#"+e+": "+limitCharacters(t,20)+"</option>"}function limitCharacters(e,t){return e.length>=20&&(e=e.substring(0,t).concat("...")),e}function clearTagsCheckboxes(){$(".objective-tag-checkbox").prop("checked",!1),$(".development-need-tag-checkbox").prop("checked",!1),objectiveTagIds=[],developmentNeedTagIds=[]}function updateObjectivesTagsList(){$(".objective-tag-checkbox").each(function(){1==$(this).prop("checked")?objectiveTagIds.indexOf(this.value)>-1||objectiveTagIds.push(this.value):objectiveTagIds.indexOf(this.value)>-1&&objectiveTagIds.splice(objectiveTagIds.indexOf(this.value),1)})}function updateDevelopmentNeedsTagsList(){$(".development-need-tag-checkbox").each(function(){1==$(this).prop("checked")?developmentNeedTagIds.indexOf(this.value)>-1||developmentNeedTagIds.push(this.value):developmentNeedTagIds.indexOf(this.value)>-1&&developmentNeedTagIds.splice(developmentNeedTagIds.indexOf(this.value),1)})}function initDatePicker(e,t){$("#"+e+"-date-picker").datepicker({useCurrent:!0,forceParse:!1,disabled:!0,daysOfWeekDisabled:[0,6],format:"yyyy-mm",startView:"months",minViewMode:"months",startDate:t,autoclose:!0}),$("#"+e+"-date").val(getToday())}function getToday(){var e=new Date;return e.getFullYear()+"-"+addZero(e.getMonth()+1)}function formatDate(e){var t=new Date(e);return fullMonths[t.getMonth()]+" "+t.getFullYear()}function formatDateShort(e){var t=new Date(e);return shortMonths[t.getMonth()]+" "+t.getFullYear()}function timeStampToDateTime(e){var t=new Date(Date.parse(e)).toUTCString();return t.substring(t.indexOf(",")+1,t.length-7)}function timeStampToDateTimeGMT(e){return addZero(e.getDate())+" "+shortMonths[e.getMonth()]+" "+e.getFullYear()+" "+addZero(e.getHours())+":"+addZero(e.getMinutes())}function timeStampToLongDate(e){var t=new Date(e),e=t.getDate()+" "+shortMonths[t.getMonth()]+" "+t.getFullYear();return e}function timeStampToClassDate(e){var t=new Date(e),e=addZero(t.getDate())+"-"+addZero(t.getMonth()+1)+"-"+t.getFullYear();return e}function reverseDateFormat(e){return e.slice(-4,e.length)+"-"+addZero(fullMonths.indexOf(e.slice(0,-5))+1)}function addZero(e){return e<10?"0"+e:e}function validateForm(e,t){checkEmpty(e,!1)?$("#"+t).prop("disabled",!0):$("#"+t).prop("disabled",!1)}function checkEmpty(e,t){var o=!1;return $("."+e).each(function(e){if(!$(this).val().trim())return o=!0,!0}),o&&t&&toastr.error("Please fill in all mandatory fields."),o}function checkEmptyID(e,t){var o=!1;return $("#"+e).val().trim()?(o&&t&&toastr.error("Please fill in all mandatory fields."),o):(o=!0,!0)}function addHTMLforPopUpBox(e){$("#pop-up-"+e).append('<div id="confirm" class="modal fade" role="dialog" style="z-index: 1600;"><div class="modal-dialog modal-sm">\x3c!-- Modal content--\x3e<div class="modal-content"><div class="modal-body">Your changes are unsaved. Are you sure you want to close this window?</div><div class="modal-footer"><button type="button" data-dismiss="modal" class="btn btn-primary" id="close-modals" onClick="$("#'+e+'").modal("hide");">Close this window</button><button type="button" data-dismiss="modal" class="btn">Cancel</button></div></div></div></div>')}function enableSubmit(e){return 1!==e}function tags(e,t){console.log(emails),$("#"+e).tagsinput({maxTags:20,confirmKeys:[9,32,44,59],trimValue:!0,typeahead:{source:t,afterSelect:function(){this.$element[0].value=""}}})}function keypress(e){$("#"+e).keypress(function(e){59==e.which&&($(this).val($(this).val()+","),e.preventDefault())})}function imgError(e,t){return e.onerror=!1,e.src="http://teams.duns.uk.sopra/_layouts/15/images/PersonPlaceholder.42x42x32.png?",e.style="min-width:"+t+"px; min-height:"+t+"px; clip:rect(0px, "+t+"px, "+t+"px, 0px); max-width:"+t+"px",!0}function getProfilePicture(e,t){return" \t\t\t<img class='backup_picture' src='http://mysite.corp.sopra/User%20Photos/Images%20du%20profil/"+e+"_SThumb.jpg?"+(new Date).getTime()+"' alt='' \tstyle='min-width:"+t+"px; min-height:"+t+"px; clip:rect(0px, "+t+"px, "+t+"px, 0px); max-width:"+t+"px;' onerror='imgError(this, "+t+");'> \t\t\t"}function openNotesBar(){var e=$(document).width(),t=$("#resizable").width();$("#resizable").animate({left:e-(t+3)+"px"}),$("#resizable").addClass("visibleBar")}function closeNotesBar(){$("#resizable").width();$("#resizable").animate({left:"100vw"}),$("#resizable").removeClass("visibleBar")}function repositionNotesBar(e,t){$(".visibleBar").css("left",t-(e+3)+"px")}function validEmails(e){var t=!0,o=e.split(",");return $.each(o,function(e,o){return t=isValidEmailAddress(o)}),t}function isValidEmailAddress(e){return/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(e)}function checkIfPastDate(e){var e=new Date(e),t=new Date;return t=new Date(t.getFullYear(),t.getMonth(),1),e<t&&(toastr.error("The 'Expected By' date can not be in the past, please change the date and try again."),!0)}function getEmailList(){$.ajax({async:!0,url:"http://"+getEnvironment()+"/data/getAllEmailAddresses",cache:!1,method:"GET",xhrFields:{withCredentials:!0},success:function(e){emails=e,initialiseTags()},error:function(e,t,o){addProposed(),console.log("error",o),toastr.error("Sorry, there was a problem getting emails, please try again later.")}})}function addTags(e,t,o){return HTML="",e.length<1&&t.length<1?HTML="No tags with this "+o+".":(e.length>0&&(HTML+="Objectives: "+e+". "),t.length>0&&(HTML+="Development Needs: "+t+".")),HTML}function openAddTagModal(e){$("#tag-id").val(e),$("#add-tag-modal").modal({backdrop:"static",keyboard:!1,show:!0})}function clickSubmitTags(){var e=$("#tag-type").val(),t=$("#tag-id").val();"feedback"===e?updateFeedbackTags(t,objectiveTagIds,developmentNeedTagIds):updateNoteTags(t,objectiveTagIds,developmentNeedTagIds)}function updateTagCheckboxes(e,t){var o=e.split(","),a=t.split(",");$(".objective-tag-checkbox").each(function(e){jQuery.inArray(this.value,o)>-1&&$(this).prop("checked",!0)}),$(".development-need-tag-checkbox").each(function(e){jQuery.inArray(this.value,a)>-1&&$(this).prop("checked",!0)}),""!==e&&(objectiveTagIds=o),""!==t&&(developmentNeedTagIds=a)}function formatTagFilterValues(e,t){var o="";return $(e).each(function(e){o+="obj-"+this+" "}),$(t).each(function(e){o+="dev-"+this+" "}),o}function deleteTag(e,t){removeNoteTagValues(e,t),removeNoteTagFilter(e,t)}function removeNoteTagValues(e,t){$(".filterable-note").each(function(o){var a=this.id.replace("note-",""),n=$("#note-obj-tags-"+a).val().split(","),i=$("#note-dev-need-tags-"+a).val().split(",");if("objective"===t){var o=n.indexOf(e);o>-1&&(n.splice(o,1),$("#note-obj-tags-"+a).val(n))}else{var o=i.indexOf(e);o>-1&&(i.splice(o,1),$("#note-dev-need-tags-"+a).val(i))}$("#note-tag-text-"+a).text(addTags(n,i,"note"))})}function removeNoteTagFilter(e,t){var o="objective"===t?"obj":"dev";$("#checkbox-"+t+"-"+e).remove(),$("#notes-tag-dropdown").find("[value="+o+"-"+e+"]").remove(),$("#notes-tag-dropdown").selectpicker("refresh")}function addTag(e,t,o){addNoteTagCheckbox(e,t,o),addNoteTagFilter(e,t,o)}function addNoteTagCheckbox(e,t,o){addToTagsLists("obj"===o?"objectivesTags":"developmentNeedsTags",e,t)}function addNoteTagFilter(e,t,o){var a="obj"===o?"objectivesTags-group":"developmentNeedsTags-group";$("#"+a).append(tagsOptionItemHTML(e,t,o)),$("#notes-tag-dropdown").selectpicker("refresh")}function editTag(e,t,o){editNoteTagCheckbox(e,t,o),editNoteTagFilter(e,t,o)}function editNoteTagCheckbox(e,t,o){var a="obj"===o?"objective":"development-need";$("#checkbox-"+a+"-"+e).find(".checkbox-title").text(limitCharacters(t,20))}function editNoteTagFilter(e,t,o){var a="obj"===o?"objectivesTags-group":"developmentNeedsTags-group";$("#"+a).find("[value="+o+"-"+e+"]").text("#"+e+": "+limitCharacters(t,20)),$("#notes-tag-dropdown").selectpicker("refresh")}$(function(){adjustDatePicker()});var emails=[],fullMonths=["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sept","Oct","Nov","Dec"],statusList=["proposed","started","completed"],statusListDivIDs=["proposed-obj","started-obj","completed-obj"],modalStatusList=["Add","Edit","Propose"],categoryIDs=["on-job-radio","classroom-radio","online-radio","self-study-radio","other-radio"],categoryList=["On Job Training","Classroom Training","Online or E-learning","Self Study","Other"],competenciesDescriptions=["Shows drive and commitment to achieve objectives. Is willing to act decisively and strives to find ways of overcoming obstacles. Takes ownership of issues and empowers team members by giving them an appropriate level of responsibility and autonomy. Does not give up and can be counted on to deliver. Is action oriented.","Expresses ideas clearly, persuasively and with impact. Listens to others and convinces them to accept their ideas. Is open and honest with colleagues and clients. Able to write or present clearly and succinctly in a variety of communication settings and audiences. Gets messages across that have the desired effect. Is timely with provision of information.","Provides clear direction and motivates and inspires others to succeed. Seeks to develop the skills and confidence of others and to recognise and develop talent. Acts as a role model and provides appropriate induction, feedback and coaching to team members. Is willing to confront and challenge poor performance and encourages team members to contribute ideas. Brings the best out of others.","Builds Sopra Steria's reputation in the market by setting high standards of service and delivery. Knows what to measure and how to measure it and looks for opportunities for synergies. Is committed to Service Excellence.","Is able to recognise opportunities to leverage Sopra Steria's capabilities to provide practical and profitable solutions to client's needs. Understands the key commercial issues that affect profitability and growth. Builds relationships with clients and seeks to understand their needs and priorities. Uses this knowledge to provide flexible and reliable solutions to meet and exceed clients' expectations and deliver value to Sopra Steria. Acts as a company Ambassador.","Takes account of a wide range of long-term changes and trends in technology, the market-place and in the business and plans ahead accordingly. Has a clear view of where they want to get to in the medium and longer term. Understands competition. Anticipates consequences and trends.","Shows flexibility and the desire to acquire new knowledge and ideas. Accepts and supports the need for change and looks for new ways of solving problems. Demonstrates the ability to lead and foster change within the organisation. Can act differently depending upon the situation and can handle uncertainty. Is committed to continuous improvement. Comes up with practical steps to implement own or others ideas.","Works cooperatively with colleagues and considers their needs and the impact of decisions on them. Seeks to build relationships across the organisation and to work for the overall good of the business. Able to find common ground and gain trust. Encourages collaboration."],nextDevNeedId=[],nextObjId=[],objectiveTagIds=[],developmentNeedTagIds=[],lastNoteID=0,emptyArray=[];Date.prototype.addDays=function(e){var t=new Date(this.valueOf());return t.setDate(t.getDate()+e),t};