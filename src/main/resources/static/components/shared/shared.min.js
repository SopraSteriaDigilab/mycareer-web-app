function adjustDatePicker(){$.fn.datepicker.noConflict=function(){return $.fn.datepicker=old,this}}function getObjectivesList(a){$.ajax({url:"http://"+getEnvironment()+":8080/getObjectives/"+a,cache:!1,method:"GET",xhrFields:{withCredentials:!0},success:function(a){lastObjID=a.length;$.each(a,function(a,b){var c=formatDate(b.timeToCompleteBy);addObjectiveToList(b.id,b.title,b.description,c,b.progress,b.isArchived,b.proposedBy)}),0==a.length&&$("#all-obj").addClass("text-center").append("<h5>You have no Objectives</h5>")},error:function(a,b,c){console.log("error",c),toastr.error("Sorry, there was a problem getting objectives, please try again later.")}})}function checkComplete(a,b){return a>=b?"complete":""}function setObjectiveModalContent(a,b,c,d,e,f){2==f?($("#proposedTo").html(proposedToHTML()),tags("proposed-obj-to"),keypress("objective-modal")):$("#proposedTo").html(""),$("#obj-modal-title-type").text(modalStatusList[f]),$("#objective-id").val(a),$("#objective-title").val(b),$("#objective-text").val(c),$("#objective-date").val(d),$("#objective-status").val(e),$("#submit-obj").prop("disabled",enableSubmit(f))}function showObjectiveModal(a){a?$("#objective-modal").modal({backdrop:"static",keyboard:!1,show:!0}):(setObjectiveModalContent("","","",getToday(),0,0),$("#proposed-obj-to").val(""),$("#objective-modal").modal("hide"))}function clickSubmitObjective(){var a=$("#obj-modal-type").val(),b=getADLoginID(),c=$("#objective-id").val(),d=$("#objective-title").val().trim(),e=$("#objective-text").val().trim(),f=$("#objective-date").val().trim(),g=parseInt($("#objective-status").val());$("#objective-is-archived").val();if(checkIfPastDate(f)||checkEmpty("objective-modal-validate",!0))return!1;if("add"===a)addObjectiveToDB(b,d,e,f,getADfullName()),showObjectiveModal(!1);else if("edit"===a)editObjectiveOnDB(b,c,d,e,f,g,getADfullName()),showObjectiveModal(!1);else{var i=$("#proposed-obj-to").val().trim();validEmails(i)?(proposeObjective(b,d,e,f,i),showObjectiveModal(!1)):(toastr.error("One or more email addresses entered are not valid"),showObjectiveModal(!0))}}function getCompetencyList(a){$.ajax({url:"http://"+getEnvironment()+":8080/getCompetencies/"+a,cache:!1,method:"GET",xhrFields:{withCredentials:!0},success:function(a){$.each(a,function(a,b){addCompetencyToList(b.id,b.title,b.compentencyDescription,b.isSelected)})},error:function(a,b,c){console.log("error",c),toastr.error("Sorry, there was a problem getting competencies, please try again later.")}})}function checkSelected(a){return a?"":"-empty"}function getGeneralFeedbackList(a){$.ajax({url:"http://"+getEnvironment()+":8080/getFeedback/"+a,cache:!1,method:"GET",xhrFields:{withCredentials:!0},success:function(a){$.each(a,function(a,b){var c=timeStampToClassDate(b.timeStamp),d=timeStampToLongDate(new Date(b.timeStamp)),e=b.fullName?b.fullName:b.fromWho;addGeneralFeedbackToList(b.id,e,b.emailBody,d,c,b.fromWho)}),0==a.length&&($("#generalFeeDescription").addClass("text-center").append("<h5>You have no Feedback </h5>"),$("#general-reviewer-list").addClass("text-center").append("<h5>You have no Reviewers </h5>"),$("#general-feedback-tab").addClass("text-center").append("<h5>You have no Reviewers </h5>"))},error:function(a,b,c){console.log("error",c),toastr.error("Sorry, there was a problem getting feedback, please try again later.")}})}function getDevelopmentNeedsList(a){$.ajax({url:"http://"+getEnvironment()+":8080/getDevelopmentNeeds/"+a,cache:!1,method:"GET",xhrFields:{withCredentials:!0},success:function(a){lastDevID=a.length,$.each(a,function(a,b){var c=isOngoing(b.timeToCompleteBy)?b.timeToCompleteBy:formatDate(b.timeToCompleteBy);addDevelopmentNeedToList(b.id,b.title,b.description,b.category,c,b.progress)}),0==a.length&&$("#all-dev-need").addClass("text-center").append("<h5>You have no Development Needs</h5>")},error:function(a,b,c){console.log("error",c),toastr.error("Sorry, there was a problem getting development needs, please try again later.")}})}function isOngoing(a){return"Ongoing"===a}function addNoteToDB(a,b,c,d,e,f){$.ajax({url:"http://"+getEnvironment()+":8080/addNote/"+a,method:"POST",xhrFields:{withCredentials:!0},data:{noteType:b,linkID:c,from:d,body:e,date:f},success:function(a){0==lastNoteID&&$("#general-notes-list").removeClass("text-center").empty(),lastNoteID++,addNoteToList(d,b,c,e,f),toastr.success(a)},error:function(a,b,c){toastr.error(a.responseText)}})}function initDatePicker(a,b){$("#"+a+"-date-picker").datepicker({useCurrent:!0,forceParse:!1,disabled:!0,daysOfWeekDisabled:[0,6],format:"yyyy-mm",startView:"months",minViewMode:"months",startDate:b,autoclose:!0}),$("#"+a+"-date").val(getToday())}function getToday(){var a=new Date;return a.getFullYear()+"-"+addZero(a.getMonth()+1)}function formatDate(a){var b=new Date(a);return fullMonths[b.getMonth()]+" "+b.getFullYear()}function timeStampToDateTime(a){var b=new Date(a),a=b.getDate()+"/"+(b.getMonth()+1)+"/"+b.getFullYear()+" "+addZero(b.getHours())+":"+addZero(b.getMinutes());return a}function timeStampToLongDate(a){var b=new Date(a),a=b.getDate()+" "+shortMonths[b.getMonth()]+" "+b.getFullYear();return a}function timeStampToClassDate(a){var b=new Date(a),a=addZero(b.getDate())+"-"+addZero(b.getMonth()+1)+"-"+b.getFullYear();return a}function reverseDateFormat(a){var b=a.slice(-4,a.length),c=fullMonths.indexOf(a.slice(0,-5))+1;return b+"-"+addZero(c)}function addZero(a){return a<10?"0"+a:a}function validateForm(a,b){var c=checkEmpty(a,!1);c?$("#"+b).prop("disabled",!0):$("#"+b).prop("disabled",!1)}function checkEmpty(a,b){var c=!1;return $("."+a).each(function(a){var b=$(this).val().trim();if(!b)return c=!0,!0}),c&&b&&toastr.error("Please fill in all mandatory fields."),c}function enableSubmit(a){return 1!==a}function tags(a){$("#"+a).tagsinput({maxTags:20,confirmKeys:[9,32,44,59],trimValue:!0})}function keypress(a){$("#"+a).keypress(function(a){59==a.which&&($(this).val($(this).val()+","),a.preventDefault())})}function imgError(a,b){return a.onerror=!1,a.src="http://teams.duns.uk.sopra/_layouts/15/images/PersonPlaceholder.42x42x32.png?",a.style="min-width:"+b+"px; min-height:"+b+"px; clip:rect(0px, "+b+"px, "+b+"px, 0px); max-width:"+b+"px",!0}function getProfilePicture(a,b){var c=new Date,d=c.getTime(),e=" \t\t\t<img class='backup_picture' src='http://mysite.corp.sopra/User%20Photos/Images%20du%20profil/"+a+"_SThumb.jpg?"+d+"' alt='' \tstyle='min-width:"+b+"px; min-height:"+b+"px; clip:rect(0px, "+b+"px, "+b+"px, 0px); max-width:"+b+"px;' onerror='imgError(this, "+b+");'> \t\t\t";return e}function openNotesBar(){var a=$(document).width(),b=$("#resizable").width();$("#resizable").animate({left:a-(b+3)+"px"})}function closeNotesBar(){$("#resizable").width();$("#resizable").animate({left:"100vw"})}function validEmails(a){var b=!0,c=a.split(",");return $.each(c,function(a,c){return b=isValidEmailAddress(c)}),b}function isValidEmailAddress(a){var b=/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;return b.test(a)}function checkIfPastDate(a){var a=new Date(a),b=new Date;return b=new Date(b.getFullYear(),b.getMonth(),1),a<b&&(toastr.error("The 'Expected By' date can not be in the past, please change the date and try again."),!0)}function showProposedObjTab(){$("#obj-all-tab").hasClass("active")||$("#obj-proposed-tab").find("a").trigger("click")}$(function(){adjustDatePicker()});var fullMonths=["January","Febuary","March","April","May","June","July","August","September","October","November","December"],shortMonths=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sept","Oct","Nov","Dec"],statusList=["proposed","started","completed"],statusListDivIDs=["proposed-obj","started-obj","completed-obj"],modalStatusList=["Add","Edit","Propose"],categoryIDs=["on-job-radio","classroom-radio","online-radio","self-study-radio","other-radio"],categoryList=["On Job Training","Classroom Training","Online or E-Learning","Self-Study","Other"],lastDevID=0,lastObjID=0,lastNoteID=0;Date.prototype.addDays=function(a){var b=new Date(this.valueOf());return b.setDate(b.getDate()+a),b};