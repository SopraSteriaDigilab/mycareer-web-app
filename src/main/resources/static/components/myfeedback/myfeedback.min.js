function initFeedbackDatePicker(a,b){$("#"+a+"-date-picker").datepicker({useCurrent:!0,forceParse:!1,disabled:!0,format:"dd-mm-yyyy",startDate:b,orientation:"bottom",autoclose:!0}),$("#feedback-start-date, #feedback-end-date").val(timeStampToClassDate(new Date))}function addGeneralFeedbackToList(a,b,c,d,e,f){$("#general-feedback-tab").append(feedbackSendersListHTML(a,b,d,e,f)),$("#generalFeeDescription").append(feedbackDescriptionListHTML(a,b,c,d,e,f)),reviewerExists(f)||$("#general-reviewer-list").append(feedbackReviewersListHTML(b,f))}function selectedFeedback(a){$(".sender-panel").each(function(b){a.id==this.id?$(this).addClass("selected-panel"):$(this).removeClass("selected-panel")})}function feedbackSendersListHTML(a,b,c,d,e){var f=" \t        <div class='panel panel-default sender-panel filterable-feedback' id='view-fee-"+a+"' style='cursor:pointer' onClick='selectedFeedback(this)'> \t        <input type='hidden' class='reviewer-filter' value='"+e+"'> \t        <input type='hidden' class='date-filter' value='"+d+"'> \t        <div class='panel-heading' onClick='showGeneralFeedback("+a+")'> \t            <div class='row'> \t               <div class='col-md-7 wrap-text'><h5><b>"+b+"</b></h5></div> \t               <div class='col-md-5'><h6 class='pull-right'><b>"+c+"</b></h6></div> \t            </div> \t        </div> \t      </div> ";return f}function feedbackReviewersListHTML(a,b){var c=" \t\t<div class='row'> \t\t\t<div class='col-md-10 wrap-only'> \t\t\t\t<label class='reviewer-label'>"+a+"</label> \t\t\t</div> \t\t\t<div class='col-md-2'> \t\t\t\t <input class='reviewer-checkbox pull-right' type='checkbox' value='"+b+"'> \t\t\t</div> \t\t</div>";return c}function feedbackDescriptionListHTML(a,b,c,d,e,f){var g=" \t<div class='panel panel-default filterable-feedback feedback-description hidden' id='feedback-"+a+"'> \t<input type='hidden' class='reviewer-filter' value='"+f+"'>     <input type='hidden' class='date-filter' value='"+e+"'> \t\t<div class='panel-body'> \t\t\t<div class='row'> \t\t\t\t<div class='col-md-6'><h6 id='from-"+a+"'><b>"+b+"</b></h6></div> \t\t\t\t<div class='col-md-6'><h6 class='pull-right' id='date-rec-"+a+"'><b>"+d+"</b></h6></div> \t\t\t</div> \t\t\t<div class='row'> \t\t\t\t<div class='col-md-12 wrap-text'><h5>"+c+"</h5></div> \t\t\t</div> \t\t </div> \t</div> ";return g}function updateEndDate(){var a=formatFeedbackDate($("#feedback-start-date").val()),b=formatFeedbackDate($("#feedback-end-date").val());a>b&&$("#feedback-end-date").val(timeStampToClassDate(a)),$("#feedback-end-date-picker").datepicker("setStartDate",a)}function formatFeedbackDate(a){var b=a.slice(0,2),c=a.slice(3,5),d=a.slice(6,10);return new Date(d+"-"+c+"-"+b)}function applyDateFilter(){for(var a=[],b=formatFeedbackDate($("#feedback-start-date").val()),c=formatFeedbackDate($("#feedback-end-date").val()),d=b;d<=c;d=d.addDays(1))a.push(timeStampToClassDate(d));$(".date-filter").each(function(b){var c=$(this).val();jQuery.inArray(c,a)>-1?$(this).closest("div").removeClass("filteredOutByDate"):$(this).closest("div").addClass("filteredOutByDate")}),dateFilterApplied=!0,updateFilterView()}function applyReviewerFilter(){var a=[];$(".reviewer-checkbox").each(function(){1==$(this).prop("checked")&&a.push(this.value)}),0==a.length?clearReviewerFilter():($(".reviewer-filter").each(function(){var b=$(this).val();jQuery.inArray(b,a)>-1?$(this).closest("div").removeClass("filteredOutByReviewer"):$(this).closest("div").addClass("filteredOutByReviewer")}),reviewerFilterApplied=!0),updateFilterView()}function updateFilterView(){$(".filterable-feedback").each(function(a){var b=$(this);b.hasClass("filteredOutByDate")||b.hasClass("filteredOutByReviewer")?b.hide():b.show()});var a=$("#filter-text");dateFilterApplied&&reviewerFilterApplied?a.text("Date: "+$("#feedback-start-date").val()+" to "+$("#feedback-end-date").val()+". Reviewer."):dateFilterApplied?a.text("Date: "+$("#feedback-start-date").val()+" to "+$("#feedback-end-date").val()+"."):reviewerFilterApplied?a.text("Reviewer."):a.text("No Filters Applied")}function clearFilter(a){"date"===a?clearDateFilter():clearReviewerFilter(),updateFilterView()}function clearReviewerFilter(){$(".reviewer-checkbox").prop("checked",!1),$(".reviewer-filter").each(function(a){$(this).closest("div").removeClass("filteredOutByReviewer")}),reviewerFilterApplied=!1}function clearDateFilter(){$("#feedback-start-date, #feedback-end-date").val(timeStampToClassDate(new Date)),updateEndDate(),$(".filterable-feedback").each(function(a){$(this).closest("div").removeClass("filteredOutByDate")}),dateFilterApplied=!1}function clearAllFilters(){clearReviewerFilter(),clearDateFilter(),updateFilterView()}function showGeneralFeedback(a){generalFeedbackID="feedback-"+a,$(".feedback-description").each(function(a){generalFeedbackID===this.id?$(this).removeClass("hidden"):$(this).addClass("hidden")})}function reviewerExists(a){var b=[];return $(".reviewer-checkbox").each(function(){b.push(this.value)}),jQuery.inArray(a,b)>-1}function openRequestFeedbackModal(){$("#requestFeedbackModal").modal({backdrop:"static",keyboard:!1,show:!0})}function submitFeedbackRequest(){$.ajax({url:"http://"+getEnvironment()+":8080/generateFeedbackRequest/"+getADLoginID(),method:"POST",xhrFields:{withCredentials:!0},data:{emailsTo:$("#requestingTo").val(),notes:$("#requestingText").val()},success:function(a){toastr.success(a)},error:function(a,b,c){toastr.error(a.responseText)}}),$("#request-feedback").click(function(){$("textarea").val(""),$("#requestingTo").tagsinput("removeAll")}),$("#requestFeedbackModal").modal("hide")}$(function(){getGeneralFeedbackList(getADLoginID()),initFeedbackDatePicker("feedback-start",""),initFeedbackDatePicker("feedback-end",new Date),$("#feedback-start-date").change(function(a){updateEndDate()}),$("#submit-date-filter").click(function(){applyDateFilter()}),$("#general-reviewer-list").change(function(){applyReviewerFilter()}),tags("requestingTo"),keypress("requestFeedbackModal"),$("#request-feedback").click(function(){openRequestFeedbackModal()}),$("#submit-request-feedback").click(function(){validEmails($("#requestingTo").val())?submitFeedbackRequest():toastr.error("One or more email addresses entered are not valid")}),$("#close-feedback-request-modal").click(function(){$("textarea").val(""),$("#requestingTo").tagsinput("removeAll")}),$("#cancel").click(function(){$("textarea").val(""),$("#requestingTo").tagsinput("removeAll")}),$("#view-feedback-template").click(function(){$("#emailTemplateModal").modal("show")})});var dateFilterApplied=!1,reviewerFilterApplied=!1,firstFeedback=!0;